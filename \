package storage

import (
	//"context"
	//"time"
	"fmt"
)

func getPosts() ([]Post, error) {
	q := `
	SELECT * FROM posts
	WHERE is_deleted = false
	ORDER BY created_at;
	`
	var res []Post

	//ctx, _ := context.WithTimeout(context.Background(),
	//		time.Second * 5)
	rows, err := DB.Query(q)
	if err != nil {
		return nil, fmt.Errorf("getPosts: %w", err)
	}

	user := User{}
	for rows.Next() {
		err := rows.Scan(
			&user.ID,
			&user.Name,
			&user.LastName,
			&user.Email,
			&user.IsAdmin,
			&user.CreatedAt,
			)

		if err != nil {
			return nil, fmt.Errorf("getPosts: %w", err)
		}

		res = append(res, user)
		
	}

}
